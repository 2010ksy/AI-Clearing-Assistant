# 🤖 AI Automated Clearing Assistant (AI 자동 반제 비서)

이 프로그램은 기업의 회계 부서에서 가장 번거로운 작업 중 하나인 **'반제(Clearing)'** 업무를 AI 기술을 활용하여 자동화하고 시각화하는 Streamlit 애플리케이션입니다.

## 🌟 프로젝트 개요
통장 입금 내역(Bank Statement)과 회사 장부의 미결 항목(Open Items)을 대조하여, 어떤 입금이 어떤 매출에 대한 것인지 AI가 스스로 판단하고 정산 전표를 생성합니다.

## 🚀 주요 기능

### 1. 지능형 매칭 엔진 (4단계 로직)
AI가 다음과 같은 단계를 거쳐 최적의 매칭을 찾아냅니다.
*   **1단계 (Reference Match)**: 전표 번호나 참조 번호가 정확히 일치하는 건 (정밀도 99%↑)
*   **2단계 (Bundle Match)**: 하나의 입금액이 여러 개의 미결 전표 합계와 일치하는 '1:N' 관계 분석
*   **3단계 (Partial Match)**: 입금액이 장부 금액보다 적거나 많을 경우, 차액 분석 및 부분 반제 처리
*   **4단계 (Name Match)**: 참조 번호가 없어도 입금자명과 거래처명을 대조하여 유사성 판단

### 2. 실시간 분석 진행 창 (with ETA)
*   분석 중 현재 진행률(%)을 시각적으로 표시합니다.
*   과거 처리 속도를 기반으로 **남은 예상 시간(ETA)**을 실시간으로 계산하여 사용자에게 정보를 제공합니다.

### 3. 대형 시뮬레이션 모달
확정 전, AI의 판단 근거를 상세히 검토할 수 있는 'Large' 사이즈의 모달을 지원합니다.
*   **요약 및 용어설명**: 초보자를 위한 회계 용어 풀이 및 전체 정산 예정 규모 표시
*   **매칭 로직 분석**: AI가 어떤 방식으로 데이터를 맞췄는지 차트로 시각화
*   **리스크 점검**: 신뢰도가 낮거나 금액 차이가 발생하는 항목 집중 표시
*   **분개 예고**: 확정 시 SAP 등 ERP 시스템에 반영될 회계 전표(31, 64 등) 미리보기

### 4. 시각적 리포트 및 다운로드
*   **음영 구분 (Shading)**: 정산 내역 목록에서 유관 전표(입금전표와 매출전표)를 같은 배경색으로 묶어 가독성을 극대화했습니다.
*   **정산 명세서**: 거래처별 요약 정보 및 전체 상세 내역을 제공합니다.
*   **파일 내보내기**: ERP 시스템 업로드를 위한 CSV/Excel 파일 다운로드를 지원합니다.

## 🛠 기술 스택
*   **Frontend/UI**: Streamlit (Python 기반 웹 프레임워크)
*   **Data Analysis**: Pandas (데이터 전처리 및 분석)
*   **Visualization**: Altair, HTML/CSS 커스텀 스타일링
*   **Internal Engine**: AI 기반 검색 및 대조 알고리즘

## 📂 파일 구조
*   `Clearing.py`: 메인 애플리케이션 소스 코드
*   `sample_open.csv` / `sample_bank.csv`: 테스트를 위한 샘플 데이터 구성

## 📖 사용 방법
1.  **파일 업로드**: 장부 파일(Open Items)과 통장 내역(Bank Statement)을 업로드합니다.
2.  **AI 분석**: 'AI 분석 시작하기' 버튼을 눌러 매칭을 진행합니다.
3.  **검토**: 시뮬레이션 화면과 리스크 점검 탭을 통해 AI의 판단을 확인합니다.
4.  **확정**: '반제 확정'을 누르면 최종 결과 파일이 생성됩니다.
5.  **다운로드**: 생성된 리포트와 업로드용 파일을 저장합니다.

---
> 본 가이드는 **AI 자동 정산 비서 v1.0**을 기준으로 작성되었습니다.
